function tzSortFilter(a,b,c){"use strict";return c&&"auto"!=c||!a.last().attr("data-order")||!a.last().data("order").toString().length||(c="filter_asc"),a.sort(function(a,b){var d=jQuery(a).data("order")?parseInt(jQuery(a).data("order"),10):jQuery(a).text().trim(),e=jQuery(b).data("order")?parseInt(jQuery(b).data("order"),10):jQuery(b).text().trim();if("*"!=jQuery(a).attr("data-option-value")&&"*"!=jQuery(b).attr("data-option-value")){if("asc"==c.substr(c.length-3,c.length).toLowerCase())return e>d?-1:d>e?1:0;if("desc"==c.substr(c.length-4,c.length).toLowerCase())return d>e?-1:e>d?1:0}}),a.each(function(a,c){b.append(c).append("\n")}),!0}function ajaxComments(a,b,c,d){"use strict";if(a.length&&a.find(".name a").length){var e="index.php?option=com_tz_portfolio&task=portfolio.ajaxcomments",f=[],g=[];d&&(e=d),a.map(function(a,b){jQuery(b).find(".name a").length&&jQuery(b).find(".name a").attr("href").length&&(f.push(jQuery(b).find(".name a").attr("href")),jQuery(b).attr("id")&&g.push(jQuery(b).attr("id")))}),jQuery.ajax({type:"post",url:e,data:{Itemid:b,url:window.Base64.encode(window.JSON.encode(f)),id:window.Base64.encode(window.JSON.encode(g))}}).success(function(a){if(a&&a.length){var b=window.JSON.decode(a);"object"==typeof b&&jQuery.each(b,function(a,b){jQuery("#"+a).find(".TzPortfolioCommentCount").length&&jQuery("#"+a).find(".TzPortfolioCommentCount").html(c+"<span>"+b+"</span>")})}})}}!function(a){"use strict";a.tzPortfolioIsotope=function(b,c){var d=a(b),e=a.extend(!0,a.tzPortfolioIsotope.defaults,c),f=e.params,g=e.isotope_options;switch(f.orderby_sec){default:g.core.sortBy="original-order",g.core.sortAscending=!1;break;case"date":g.core.sortBy="date",g.core.sortAscending=!0,e.timeline&&(g.core.sortAscending=!1);break;case"rdate":g.core.sortBy="date",g.core.sortAscending=!1;break;case"alpha":g.core.sortBy="name",g.core.sortAscending=!0;break;case"ralpha":g.core.sortBy="name",g.core.sortAscending=!1;break;case"author":g.core.sortBy="date",g.core.sortAscending=!1;break;case"rauthor":g.core.sortBy="date",g.core.sortAscending=!1;break;case"hits":g.core.sortBy="hits",g.core.sortAscending=!1;break;case"rhits":g.core.sortBy="hits",g.core.sortAscending=!0}a.tzPortfolioIsotope.tz_init=function(b){var c=a(e.mainElementSelector).width(),h=e.columnWidth,i=0,j=0,k=0,l=0,m=0;e.timeline&&a.extend(!0,a.Isotope.prototype,{_sort:function(){var b=this.options.sortBy,c=this._getSorter,d=this.options.sortAscending?1:-1,e=function(e,f){var g=c(e,b),h=c(f,b);if(g===h&&"original-order"!==b&&(g=c(e,"original-order"),h=c(f,"original-order")),"name"==b||"hits"==b){if(a(e).attr("data-category")>a(f).attr("data-category"))return 0;if(a(e).attr("data-category")==a(f).attr("data-category"))return a(e).hasClass("TzDate")?0:g>h?1*d:0}return(g>h?1:h>g?-1:0)*d};this.$filteredAtoms.sort(e)}}),i=Math.floor(c/h),e.beforeCalculateColumn(i),j=i+1,k=j-c/h>c/h-i?i:j,l=c,m=c,k>1&&(l=Math.floor(c/k),m=2*l),e.afterCalculateColumn(k,l),a(d.selector+" .element").width(l),a(e.elementFeatureSelector).width(m),a(d.selector+" .element.TzDate").width(c);var n=a(d.selector);b&&n.find(".element").css({opacity:0}),n.imagesLoaded(function(){e.afterImagesLoaded(),b&&n.find(".element").css({opacity:1}),n.isotope({itemSelector:g.core.itemSelector,layoutMode:g.core.layoutMode,sortBy:g.core.sortBy,sortAscending:g.core.sortAscending,filter:g.core.filter,masonry:{columnWidth:l},getSortData:g.core.getSortData},function(){parseInt(f.tz_show_filter,10)&&f.filter_tags_categories_order&&"undefined"!=typeof window.tzSortFilter&&window.tzSortFilter(a("#filter").find("a"),a("#filter"),f.filter_tags_categories_order),g.complete()})})},a.tzPortfolioIsotope.loadPortfolio=function(){var b=a(g.filterSelector),c=b.find(g.tagFilter),e=null,h=g.core;c.click(function(b){b.preventDefault();var c=a(this);if(c.hasClass("selected"))return!1;var g=c.parents(".option-set");g.find(".selected").removeClass("selected"),c.addClass("selected");var i=h,j=g.attr("data-option-key"),k=c.attr("data-option-value");return k="false"===k?!1:k,i[j]=k,"layoutMode"===j&&"function"==typeof window.changeLayoutMode?window.changeLayoutMode(c,i):("name"==k&&("alpha"==f.orderby_sec||"alpha"!=f.orderby_sec&&"ralpha"!=f.orderby_sec?i.sortAscending=!0:"ralpha"==f.orderby_sec&&(i.sortAscending=!1)),"date"==k&&("rdate"==f.orderby_sec||"date"!=f.orderby_sec&&"rdate"!=f.orderby_sec?i.sortAscending=!1:"date"==f.orderby_sec&&(i.sortAscending=!0)),"hits"==k&&("hits"==f.orderby_sec||"hits"!=f.orderby_sec&&"rhits"!=f.orderby_sec?i.sortAscending=!1:"rhits"==f.orderby_sec&&(i.sortAscending=!0)),i=a.extend(e,i),a(d.selector).isotope(i),e=i),!1})},a.tzPortfolioIsotope.tz_init(!0),a(g.filterSelector+"[data-option-key=sortBy]").children().removeClass("selected").end().find("[data-option-value="+g.core.sortBy+"]").addClass("selected"),a.tzPortfolioIsotope.loadPortfolio();var h=null;return a(window).bind("load resize",function(){h&&clearTimeout(h),h=setTimeout(a.tzPortfolioIsotope.tz_init(),100)}),this},a.tzPortfolioIsotope.defaults={columnWidth:233,mainElementSelector:"#TzContent",containerElementSelector:"#portfolio",elementFeatureSelector:".tz_feature_item",JSON:{},timeline:!1,params:{orderby_sec:"rdate",tz_show_filter:1,filter_tags_categories_order:"auto",tz_portfolio_layout:"ajaxButton",comment_function_type:"default",tz_filter_type:"categories",show_all_filter:0,tz_comment_type:"disqus",tz_show_count_comment:1},isotope_options:{core:{itemSelector:".element",layoutMode:"masonry",sortBy:"date",sortAscending:!1,filter:"*",getSortData:{date:function(a){var b=a.hasClass("element")&&a.attr("data-date").length?a.attr("data-date"):a.find(".create").text();return parseInt(b,10)},hits:function(a){var b=a.hasClass("element")&&a.attr("data-hits").length?a.attr("data-hits"):a.find(".hits").text();return parseInt(b,10)},name:function(a){var b=a.hasClass("element")&&a.find(".TzPortfolioTitle.name").length?a.find(".TzPortfolioTitle.name").text().trim():a.attr("data-title").length?a.attr("data-title"):"",c=b.length?b:a.text().trim();return c}}},filterSelector:"#tz_options .option-set",tagFilter:"a",complete:function(){}},beforeCalculateColumn:function(){},afterCalculateColumn:function(){},afterImagesLoaded:function(){}},a.fn.tzPortfolioIsotope=function(b){return void 0===b&&(b={}),"object"==typeof b?new a.tzPortfolioIsotope(this,b):void 0},a.tzInfiniteScroll=function(b,c){function d(){var b=[];return a("#filter a").each(function(){b.push(a(this).attr("data-option-value").replace(".",""))}),window.JSON.encode(b)}function e(){var b=[];return a("#filter a").each(function(){b.push(a(this).attr("data-option-value").replace(".category",""))}),window.JSON.encode(b)}var f=a(b),g=a.extend(!0,a.tzInfiniteScroll.defaults,c),h=g.params,i=1,j=a(f.selector),k=!0,l=a("div.TzDate:last").attr("data-category");j.infinitescroll({navSelector:"#loadaj a",nextSelector:"#loadaj a:first",itemSelector:".element",errorCallback:function(){g.errorCallback||("ajaxButton"==h.tz_portfolio_layout&&a("#tz_append a").unbind("click").html(g.loadedText).show(),"ajaxInfiScroll"==h.tz_portfolio_layout&&a("#tz_append").removeAttr("style").html('<a class="tzNomore">'+g.loadedText+"</a>"),a("#tz_append a").addClass("tzNomore"),a("#infscr-loading").css("display","none"))},loading:{msgText:g.msgText,finishedMsg:"",img:g.rootPath+"components/com_tz_portfolio/assets/ajax-loader.gif",selector:"#tz_append"}},function(b){a("#infscr-loading").css("display","none");var c=a(b).css({opacity:0});"js"==h.comment_function_type&&parseInt(h.tz_show_count_comment,10)&&("facebook"==h.tz_comment_type||"disqus"==h.tz_comment_type)&&"undefined"!=typeof window.ajaxComments&&window.ajaxComments(c,g.itemID,g.commentText),c.imagesLoaded(function(){c.animate({opacity:1}),a.tzPortfolioIsotope.tz_init(),g.timeline?(j.isotope("insert",c),c.each(function(){var b=a(this).attr("class");if(b.match(/.*?TzDate.*?/i)){var c=a(this).attr("data-category");l==c?(a(this).remove(),j.isotope("reloadItems")):l=c}})):j.isotope("appended",c),i++,parseInt(h.tz_show_filter,10)&&(parseInt(h.show_all_filter,10)||("tags"==h.tz_filter_type&&a.ajax({url:"index.php?option=com_tz_portfolio&task=portfolio.ajaxtags",data:{tags:d(),Itemid:g.itemID,page:i}}).success(function(b){if(b.length){var c=a(b);a("#filter").append(c),a.tzPortfolioIsotope.loadPortfolio(),h.filter_tags_categories_order&&"undefined"!=typeof window.tzSortFilter&&window.tzSortFilter(a("#filter").find("a"),a("#filter"),h.filter_tags_categories_order)}}),"categories"==h.tz_filter_type&&a.ajax({url:"index.php?option=com_tz_portfolio&task=portfolio.ajaxcategories",data:{catIds:e(),Itemid:g.itemID,page:i}}).success(function(b){if(b.length){var c=a(b);a("#filter").append(c),a.tzPortfolioIsotope.loadPortfolio(),h.filter_tags_categories_order&&"undefined"!=typeof window.tzSortFilter&&window.tzSortFilter(a("#filter").find("a"),a("#filter"),h.filter_tags_categories_order)}}))),c.length&&a("div#tz_append").find("a:first").show()}),k=!0}),"ajaxInfiScroll"==h.tz_portfolio_layout&&a(window).scroll(function(){a(window).unbind(".infscr"),k&&a(window).scrollTop()+a(window).height()>=a(document).height()-50&&(k=!1,j.infinitescroll("retrieve"))}),"ajaxButton"==h.tz_portfolio_layout&&(a(window).unbind(".infscr"),a("div#tz_append a").click(function(){a(this).stop(),a("div#tz_append").find("a:first").hide(),j.infinitescroll("retrieve")}))},a.tzInfiniteScroll.defaults={rootPath:"",msgText:'<i class="tz-icon-spinner tz-spin"></i><em>Loading the next set of posts...</em>',loadedText:"No more pages to load",navSelector:"#loadaj a",nextSelector:"#loadaj a:first",itemSelector:".element",itemID:null,commentText:"Comment count:",timeline:!1,errorCallback:null},a.fn.tzInfiniteScroll=function(b){return void 0===b&&(b={}),"object"==typeof b?new a.tzInfiniteScroll(this,b):void 0}}(jQuery);