var slbox=jQuery.noConflict();if(slbox.fn.extend({selectbox:function(a){return this.each(function(){new slbox.SelectBox(this,a)})}}),!window.console)var console={log:function(){}};slbox.SelectBox=function(a,b){function c(){n=0,p.hide()}function d(){p.append(i(q.attr("id"))).hide();var a=q.css("width");p.width(a)}function e(a){var b=document.createElement("div");return p=slbox(b),p.attr("id",k+"_container"),p.addClass(a.containerClass),p}function f(a){var b=document.createElement("input"),c=slbox(b);return c.attr("id",k+"_input"),c.attr("type","text"),c.addClass(a.inputClass),c.attr("autocomplete","off"),c.attr("readonly","readonly"),c.attr("tabIndex",o.attr("tabindex")),c}function g(a){var b=slbox("li",p);b&&(l+=a,0>l?l=0:l>=b.size()&&(l=b.size()-1),b.removeClass(j.hoverClass),slbox(b[l]).addClass(j.hoverClass))}function h(){var a=slbox("li."+j.currentClass,p).get(0),b=(""+a.id).split("_"),c=b[b.length-1];return o.val(c),q.val(slbox(a).html()),!0}function i(a){var b=(new Array,document.createElement("ul"));return o.children("option").each(function(){var d=document.createElement("li");d.setAttribute("id",a+"_"+slbox(this).val()),d.innerHTML=slbox(this).html(),slbox(this).is(":selected")&&(q.val(slbox(this).html()),slbox(d).addClass(j.currentClass)),b.appendChild(d),slbox(d).mouseover(function(a){n=1,j.debug&&console.log("over on : "+this.id),slbox(a.target,p).addClass(j.hoverClass)}).mouseout(function(a){n=-1,j.debug&&console.log("out on : "+this.id),slbox(a.target,p).removeClass(j.hoverClass)}).click(function(){slbox("li."+j.hoverClass,p).get(0);j.debug&&console.log("click on :"+this.id),slbox("li."+j.currentClass).removeClass(j.currentClass),slbox(this).addClass(j.currentClass),h(),c()})}),b}var j=b||{};j.inputClass=j.inputClass||"selectbox",j.containerClass=j.containerClass||"selectbox-wrapper",j.hoverClass=j.hoverClass||"current",j.currentClass=j.selectedClass||"selected",j.debug=j.debug||!1;var k=a.id,l=-1,m=!1,n=0,o=slbox(a),p=e(j),q=f(j);o.hide().before(q).before(p),d(),q.click(function(){m||p.toggle()}).focus(function(){p.not(":visible")&&(m=!0,p.show())}).keydown(function(a){switch(a.keyCode){case 38:a.preventDefault(),g(-1);break;case 40:a.preventDefault(),g(1);break;case 13:a.preventDefault(),slbox("li."+j.hoverClass).trigger("click");break;case 27:c()}}).blur(function(){p.is(":visible")&&n>0?j.debug&&console.log("container visible and has focus"):c()})};